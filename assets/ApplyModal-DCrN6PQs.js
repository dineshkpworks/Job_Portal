import{r as i,b as k,u as j,j as e,B as x,i as w,k as N,l as S}from"./index-BTZwPIQt.js";function A({job:a,onClose:n,onSuccess:f}){const[s,c]=i.useState(null),[o,r]=i.useState(""),[u,m]=i.useState(!1),p=i.useRef(null),{user:d}=k(),{setAppliedIds:b}=j(),y=l=>{const t=l.target.files?.[0];if(r(""),t&&t.type!=="application/pdf"){r("Only PDF files are allowed."),c(null);return}c(t||null)},g=async l=>{if(l.preventDefault(),!d||!a||!s){r("Please select a PDF resume.");return}m(!0),r("");try{const t=await N(d.uid,s);await S(d.uid,a.id,t),b(h=>new Set(h).add(a.id)),f?.(),n()}catch(t){r(t.message||"Application failed.")}finally{m(!1)}};return a?e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/20",onClick:n,children:e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded border border-[#e5e7eb] dark:border-gray-700 max-w-md w-full p-5",onClick:l=>l.stopPropagation(),children:[e.jsxs("h2",{className:"text-lg font-semibold text-[#111827] dark:text-white mb-0.5",children:["Apply for ",a.title]}),e.jsx("p",{className:"text-sm text-[#6b7280] dark:text-gray-400 mb-4",children:a.company}),e.jsxs("form",{onSubmit:g,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-[#6b7280] dark:text-gray-300 mb-1",children:"Resume (PDF only, max 5MB)"}),e.jsx("input",{ref:p,type:"file",accept:".pdf,application/pdf",onChange:y,className:"w-full text-sm text-[#6b7280] dark:text-gray-400 file:mr-3 file:py-1.5 file:px-3 file:rounded file:border file:border-[#e5e7eb] file:bg-white file:text-[#111827] dark:file:bg-gray-700 dark:file:border-gray-600 dark:file:text-gray-300"}),s&&e.jsx("p",{className:"mt-1 text-xs text-gray-500",children:s.name})]}),o&&e.jsx("p",{className:"text-sm text-red-600 dark:text-red-400",children:o}),e.jsxs("div",{className:"flex gap-2 justify-end pt-1",children:[e.jsx(x,{type:"button",variant:"secondary",onClick:n,children:"Cancel"}),e.jsx(x,{type:"submit",variant:"primary",disabled:!s||u,children:u?e.jsx(w,{size:"sm"}):"Submit"})]})]})]})}):null}export{A};
